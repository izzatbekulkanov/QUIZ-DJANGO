{% extends 'dashboard/index.html' %}
{% load static %}

{% block style %}
{% endblock style %}


{% block content %}
    <main id="main-container">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="bg-body-light border-bottom mb-4">
      <div class="content py-2">
        <ol class="breadcrumb mb-0">
          <li class="breadcrumb-item">
            <a href="{% url 'dashboard' %}"><i class="fa fa-home"></i> Bosh sahifa</a>
          </li>
          <li class="breadcrumb-item">
            <a href="{% url 'dashboard-categories' %}">Kategoriyalar</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">Tafsilotlar</li>
        </ol>
      </div>
    </nav>
    <!-- END Breadcrumb -->
      <div class="content">
      <h2 class="mb-4">{{ category.name }} - Taqdim etilgan testlar</h2>
      <div class="row">
        {% if assignments %}
          <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">
              <thead class="table-primary text-center">
                <tr>
                  <th>#</th>
                  <th>O'qituvchi</th>
                  <th>Test</th>
                  <th>Savollar soni</th>
                  <th>Boshlanish vaqti</th>
                  <th>Tugash vaqti</th>
                  <th>Boshlash</th>
                </tr>
              </thead>
              <tbody>
                {% for assignment in assignments %}
                  <tr>
                    <td class="text-center">{{ forloop.counter }}</td>
                    <td>{{ assignment.teacher.first_name }} {{ assignment.teacher.second_name }}</td>
                    <td>{{ assignment.test.name }}</td>
                    <td class="text-center">{{ assignment.total_questions }}</td>
                    <td>{{ assignment.start_time|date:"Y-m-d H:i" }}</td>
                    <td>{{ assignment.end_time|date:"Y-m-d H:i" }}</td>
                    <td class="text-center">
                        <button class="btn btn-sm btn-primary start-test-btn" data-assignment-id="{{ assignment.id }}">
                            <i class="fa fa-play me-1"></i>Boshlash
                        </button>
                    </td>
                  </tr>
                {% empty %}
                  <tr>
                    <td colspan="7" class="text-center text-muted">Hech qanday topshiriq mavjud emas.</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="text-muted">Hozircha ushbu kategoriyaga tegishli testlar mavjud emas.</p>
        {% endif %}
      </div>
    </div>
    </main>
{% endblock content %}



{% block script %}

    <script src="{% static 'assets/js/plugins/sweetalert2/sweetalert2.all.min.js' %}"></script>

  <script>
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.start-test-btn').forEach(button => {
        button.addEventListener('click', function () {
            const assignmentId = this.getAttribute('data-assignment-id');

            window.location.href = `/start-test-detail/${assignmentId}/`;
        });
    });
});
  </script>
{% endblock script %}